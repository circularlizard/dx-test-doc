<!-- Elements added to main will be displayed on all pages -->

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.4">
    
    
      
        <title>Runtime log levels - DBHA - DX Test Site</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bb3983ee.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#postgres" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../.."> 


    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DX Test Site" class="md-header__button md-logo" aria-label="DX Test Site" data-md-component="logo">
      
  <img src="../../assets/dx_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DX Test Site
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Runtime log levels - DBHA
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../what%27s-new/new_cf17/" class="md-tabs__link">
        What's new
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Kube
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DX Test Site" class="md-nav__button md-logo" aria-label="DX Test Site" data-md-component="logo">
      
  <img src="../../assets/dx_logo.png" alt="logo">

    </a>
    DX Test Site
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" data-md-state="indeterminate" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          What's new
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="What's new" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          What's new
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/new_cf17/" class="md-nav__link">
        What's new in CF17?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/new_cf171/" class="md-nav__link">
        What's new in CF171? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/new_cf172/" class="md-nav__link">
        What's new in CF172? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/new_cf173/" class="md-nav__link">
        What's new in CF173? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/new_cf18/" class="md-nav__link">
        What's new in CF18? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/new_noncf18/" class="md-nav__link">
        What's new in CF18?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf182/" class="md-nav__link">
        What's new in CF182? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf183/" class="md-nav__link">
        What's new in CF183? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf184/" class="md-nav__link">
        What's new in CF184? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf19/" class="md-nav__link">
        What's new in CF19? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/new_noncf19/" class="md-nav__link">
        What's new with CF19?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf191/" class="md-nav__link">
        What's new in CF191? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf192/" class="md-nav__link">
        What's new in CF192? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf193/" class="md-nav__link">
        What's new in CF193? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf194/" class="md-nav__link">
        What's new in CF194? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf195/" class="md-nav__link">
        What's new in CF195? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf196/" class="md-nav__link">
        What's new in CF196? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/new_noncf196/" class="md-nav__link">
        What's new in CF196?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf197/" class="md-nav__link">
        What's new in CF197? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/new_noncf197/" class="md-nav__link">
        What's new with CF197?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf198/" class="md-nav__link">
        What's new in CF198? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/new_noncf198/" class="md-nav__link">
        What's new with CF198?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/newcf199/" class="md-nav__link">
        What's new in CF199? Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/new_noncf199/" class="md-nav__link">
        What's new with CF199?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../what%27s-new/new_cf181/" class="md-nav__link">
        What's new in CF181? Containers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Kube</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Kube" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Kube
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../k8s-next-deploy/" class="md-nav__link">
        Deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../k8s-next-operation/" class="md-nav__link">
        Operations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../k8s-next-runtime-log-levels/" class="md-nav__link">
        Runtime log levels
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Runtime log levels - DBHA
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Runtime log levels - DBHA
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#postgres" class="md-nav__link">
    Postgres
  </a>
  
    <nav class="md-nav" aria-label="Postgres">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-postgresqlconf" class="md-nav__link">
    Update postgresql.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-in-database" class="md-nav__link">
    Update in database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repmgr" class="md-nav__link">
    Repmgr
  </a>
  
    <nav class="md-nav" aria-label="Repmgr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-repmgrconf" class="md-nav__link">
    Update repmgr.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-changes" class="md-nav__link">
    Additional changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#periodically-check-for-global-log-config-and-translate-to-compatible-log-config" class="md-nav__link">
    Periodically check for global log config and translate to compatible log config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pgpool" class="md-nav__link">
    Pgpool
  </a>
  
    <nav class="md-nav" aria-label="Pgpool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-pgpoolconf" class="md-nav__link">
    Update pgpool.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-in-database-do-not-use-for-our-case" class="md-nav__link">
    Update in database (Do not use for our case)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#periodically-check-for-global-log-config-and-translate-to-compatible-log-config_1" class="md-nav__link">
    Periodically check for global log config and translate to compatible log config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_6" data-md-state="indeterminate" type="checkbox" id="__nav_3_6" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_6">
          Prometheus
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Prometheus" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          Prometheus
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Prometheus/k8s-next-nodejs-prom/" class="md-nav__link">
        NodeJS Metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Prometheus/k8s-next-postgres-prom/" class="md-nav__link">
        Postgres Metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Prometheus/k8s-next-prom/" class="md-nav__link">
        Prometheus
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_7" data-md-state="indeterminate" type="checkbox" id="__nav_3_7" checked>
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_7">
          Migration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Migration" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          Migration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Migration/k8s-next-migrate-from-operator/" class="md-nav__link">
        Operator migration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Migration/k8s-next-migrate-detail-core/" class="md-nav__link">
        Operator migration - core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Migration/k8s-next-migrate-detail-dam/" class="md-nav__link">
        Operator migration - DAM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Migration/k8s-next-property-migration/" class="md-nav__link">
        Operator property migration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../k8s-next-update/" class="md-nav__link">
        Updating
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../k8s-next-undeploy/" class="md-nav__link">
        Undeploy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../k8s-next-conclusion/" class="md-nav__link">
        Conclusion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../k8s-next-helm-incubator-values/" class="md-nav__link">
        Incubator configurations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#postgres" class="md-nav__link">
    Postgres
  </a>
  
    <nav class="md-nav" aria-label="Postgres">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-postgresqlconf" class="md-nav__link">
    Update postgresql.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-in-database" class="md-nav__link">
    Update in database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repmgr" class="md-nav__link">
    Repmgr
  </a>
  
    <nav class="md-nav" aria-label="Repmgr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-repmgrconf" class="md-nav__link">
    Update repmgr.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-changes" class="md-nav__link">
    Additional changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#periodically-check-for-global-log-config-and-translate-to-compatible-log-config" class="md-nav__link">
    Periodically check for global log config and translate to compatible log config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pgpool" class="md-nav__link">
    Pgpool
  </a>
  
    <nav class="md-nav" aria-label="Pgpool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-pgpoolconf" class="md-nav__link">
    Update pgpool.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-in-database-do-not-use-for-our-case" class="md-nav__link">
    Update in database (Do not use for our case)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#periodically-check-for-global-log-config-and-translate-to-compatible-log-config_1" class="md-nav__link">
    Periodically check for global log config and translate to compatible log config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

  <h1>Runtime log levels - DBHA</h1>

<h2 id="postgres">Postgres</h2>
<p>The log levels for Postgres are defined by the <a href="https://www.postgresql.org/docs/9.1/runtime-config-logging.html#GUC-LOG-MIN-MESSAGES"><code>log_min_messages</code> parameter</a>. Supported values are:</p>
<p><code>DEBUG5</code>, <code>DEBUG4</code>, <code>DEBUG3</code>, <code>DEBUG2</code>, <code>DEBUG1</code>, <code>INFO</code>, <code>NOTICE</code>, <code>WARNING</code>, <code>ERROR</code>, <code>LOG</code>, <code>FATAL</code>, <code>PANIC</code></p>
<p>Log levels for Postgres can be adjusted in different ways. </p>
<h3 id="update-postgresqlconf">Update postgresql.conf</h3>
<p>In the current build of the DBHA Postgres image, the <code>postgresql.conf</code> is located in <code>/var/lib/pgsql/11/data/dx/</code>. It includes the <code>log_min_messages</code> which is commented out by default. After it was changed, the configuration can be reloaded without restarting Postgres with</p>
<pre><code class="language-shell">repmgr node service --action=reload
</code></pre>
<h3 id="update-in-database">Update in database</h3>
<p>Another way of configuring the log level is to alter the entry in the database directly. For that we can connect to the database inside the container using <code>psql</code>. To change and apply the level change, we use</p>
<pre><code class="language-sql">ALTER SYSTEM SET log_min_messages = 'DEBUG5';
SELECT pg_reload_conf();
</code></pre>
<h2 id="repmgr">Repmgr</h2>
<p>The log levels for the Repmgr are defined by the <a href="https://repmgr.org/docs/4.1/configuration-file-log-settings.html#REPMGR-CONF-LOG-LEVEL"><code>log_level</code> parameter</a>. Supported values are:</p>
<p><code>DEBUG</code>, <code>INFO</code>, <code>NOTICE</code>, <code>WARNING</code>, <code>ERROR</code>, <code>ALERT</code>, <code>CRIT</code>, <code>EMERG</code></p>
<p>Log levels for Postgres can be adjusted the following way. </p>
<h3 id="update-repmgrconf">Update repmgr.conf</h3>
<p>In the current build of the DBHA Postgres image, the <code>repmgr.conf</code> is located in <code>/etc/repmgr/11</code>. It includes the <code>log_level</code> which is commented out by default. After it was changed, the configuration can be reloaded without restarting Repmgr with</p>
<pre><code class="language-shell">kill -SIGHUP `cat /tmp/repmgrd.pid`
</code></pre>
<h3 id="additional-changes">Additional changes</h3>
<p>In order to make those changes applicable, we need to make some slight changes to the <code>start_postgres.sh</code> script. We need to remove the following lines to enable logging to <code>stdout</code>:</p>
<pre><code class="language-shell">__repmgr_set_property &quot;log_file&quot; &quot;${PG_CONFDIR}/repmgr/log/repmgr.log&quot; &quot;${REPMGR_CONF_DIR}/repmgr.conf&quot;
__repmgr_set_property &quot;log_level&quot; &quot;NOTICE&quot; &quot;${REPMGR_CONF_DIR}/repmgr.conf&quot;
</code></pre>
<h3 id="periodically-check-for-global-log-config-and-translate-to-compatible-log-config">Periodically check for global log config and translate to compatible log config</h3>
<p>We can create a shell script that runs in the image and periodically checks for changes in the global log config that is mounted in the container at <code>/etc/global-config/log.persistenceNode</code>.</p>
<p>Example log string:</p>
<pre><code>pers-db:::info,pers-repmgr:::info
</code></pre>
<pre><code class="language-shell">#!/bin/bash

#
####################################################################
# Licensed Materials - Property of HCL                             #
#                                                                  #
# Copyright HCL Technologies Ltd. 2021. All Rights Reserved.       #
#                                                                  #
# Note to US Government Users Restricted Rights:                   #
#                                                                  #
# Use, duplication or disclosure restricted by GSA ADP Schedule    #
####################################################################
#


# Load libraries
. /set_repmgr_property.sh

# Define service name
PG_SERVICE=&quot;pers-db&quot;
REPMGR_SERVICE=&quot;pers-repmgr&quot;
REPMGR_CONF_DIR='/etc/repmgr/11'

# Define log level mapping for Postgres
declare -A PG_MAP
PG_MAP['debug']='DEBUG5' # logs DEBUG5, DEBUG4, DEBUG3, DEBUG2, DEBUG1
PG_MAP['info']='INFO' # logs INFO, NOTICE, WARNING
PG_MAP['error']='ERROR' # logs ERROR, LOG, FATAL, PANIC

# Define log level mapping for Repmgr
declare -A REPMGR_MAP
REPMGR_MAP['debug']='DEBUG' # logs DEBUG
REPMGR_MAP['info']='INFO' # logs INFO, NOTICE, WARNING
REPMGR_MAP['error']='ERROR' # logs ERROR, ALERT, CRIT, EMERG


Map_Level()
{
  # Transform to lowercase
  INPUT_LEVEL=$(echo &quot;$1&quot; | tr '[:upper:]' '[:lower:]')

  SERVICE=$2

  # Returns mapped value if it exists, oterwise empty string
  if [[ $SERVICE == $PG_SERVICE ]]; then
    echo ${PG_MAP[$INPUT_LEVEL]}
  elif [[ $SERVICE == $REPMGR_SERVICE ]]; then
    echo ${REPMGR_MAP[$INPUT_LEVEL]}
  else
    echo &quot;&quot;
  fi
}

Parse_And_Set_Level()
{

  # Split by comma
  IFS=',' read -ra LOG_STR &lt;&lt;&lt; $1

  for LOG_PART in &quot;${LOG_STR[@]}&quot;; do
    # Split by colon
    IFS=':' read -ra LOG_STR_PARTS &lt;&lt;&lt; $LOG_PART

    # Get common log pattern elements
    SERVICE=${LOG_STR_PARTS[0]}
    # Transform to lowercase
    LOWERCASE_SERVICE=$(echo &quot;$SERVICE&quot; | tr '[:upper:]' '[:lower:]')

    # Suffix and component are currently not used in this service
    # SUFFIX=${LOG_STR_PARTS[1]}
    # COMPONENT=${LOG_STR_PARTS[2]}

    LEVEL=${LOG_STR_PARTS[${#LOG_STR_PARTS[@]} - 1]}

    # Only apply logs for the matching service
    if [[ $LOWERCASE_SERVICE == $PG_SERVICE ]]; then
      MAPPED_LEVEL=$(Map_Level &quot;$LEVEL&quot; $PG_SERVICE)

      if [[ $MAPPED_LEVEL != &quot;&quot; ]]; then
        # Setting the log level
        echo &quot;Setting Postgres log level to $MAPPED_LEVEL&quot; &amp;&amp; \
        psql -c &quot;ALTER SYSTEM SET log_min_messages = '$MAPPED_LEVEL';&quot; &amp;&amp; \
        psql -c &quot;SELECT pg_reload_conf();&quot; || \
        echo &quot;Failed to set Postgres log level to $MAPPED_LEVEL&quot;
      fi
    elif [[ $LOWERCASE_SERVICE == $REPMGR_SERVICE ]]; then
      MAPPED_LEVEL=$(Map_Level &quot;$LEVEL&quot; $REPMGR_SERVICE)

      if [[ $MAPPED_LEVEL != &quot;&quot; ]]; then
        # Setting the log level
        echo &quot;Setting Repmgr log level to $MAPPED_LEVEL&quot; &amp;&amp; \
        __repmgr_set_property &quot;log_level&quot; &quot;${MAPPED_LEVEL}&quot; &quot;${REPMGR_CONF_DIR}/repmgr.conf&quot; &amp;&amp; \
        kill -HUP `cat /tmp/repmgrd.pid` || \
        echo &quot;Failed to set Repmgr log level to $MAPPED_LEVEL&quot;
      fi
    fi

  done
}

Periodically_Read_Ronfigfile() {
  FILE_PATH=$1
  # Sleep time defaults to 10 seconds if not passed as argument
  SLEEP_TIME_SECONDS=${2:-10}

  LAST_CONFIG_STRING=''

  while [ true ]; do
    if [[ -f ${FILE_PATH} || -L ${FILE_PATH} ]]; then
      # Deal with the fact that the file referenced could actually be a symlink to a file
      FULLY_RESOLVED_FILE_PATH=$(readlink -f ${FILE_PATH})

      # read exactly the first line from that file
      read -r first_line &lt; ${FULLY_RESOLVED_FILE_PATH}
      if [ &quot;${LAST_CONFIG_STRING}&quot; != &quot;${first_line}&quot; ]; then
        LAST_CONFIG_STRING=${first_line}
        Parse_And_Set_Level &quot;$first_line&quot;
      else
        echo &quot;Nothing done because log config didn't change in ${FULLY_RESOLVED_FILE_PATH} in last&quot; ${SLEEP_TIME_SECONDS} &quot;seconds&quot;
    fi
    else
      echo &quot;Config map ${FILE_PATH} doesn't exist. No action taken&quot;
    fi
    sleep ${SLEEP_TIME_SECONDS}
  done
}

# Start periodic file check
Periodically_Read_Ronfigfile &quot;/etc/global-config/log.persistenceNode&quot; 10
</code></pre>
<h2 id="pgpool">Pgpool</h2>
<p>The log levels for Pgpool are defined by the <a href="https://www.pgpool.net/docs/41/en/html/runtime-config-logging.html#GUC-LOG-MIN-MESSAGES"><code>log_min_messages</code> parameter</a>. Supported values are:</p>
<p><code>DEBUG5</code>, <code>DEBUG4</code>, <code>DEBUG3</code>, <code>DEBUG2</code>, <code>DEBUG1</code>, <code>INFO</code>, <code>NOTICE</code>, <code>WARNING</code>, <code>ERROR</code>, <code>LOG</code>, <code>FATAL</code>, <code>PANIC</code></p>
<p>Log levels for Pgpool can be adjusted in different ways. </p>
<h3 id="update-pgpoolconf">Update pgpool.conf</h3>
<p>In the current build of the DBHA Pgpool image, the <code>pgpool.conf</code> is located in <code>/conf</code>. It includes the <code>log_min_messages</code> which is commented out by default. After it was changed, the configuration can be reloaded without restarting Postgres with</p>
<pre><code class="language-shell">pgpool --config-file=/conf/pgpool.conf --hba-file=/conf/pool_hba.conf reload
</code></pre>
<p>We are currently using Pgpool 4.1. With 4.2, a new command <a href="https://www.pgpool.net/docs/42/en/html/pcp-reload-config.html"><code>pcp_reload_config</code> was introduced</a>. If we upgrade to 4.2 in the future, this can probably replace the command above.</p>
<h3 id="update-in-database-do-not-use-for-our-case">Update in database <em>(Do not use for our case)</em></h3>
<p>Another way of configuring the log level is to alter the entry in the database directly. For that we can connect to the database inside the container using</p>
<p><strong>Important Note:</strong> </p>
<blockquote>
<p>Do not use this for our use case! This can in some cases work unreliably if it is executed during failover or the setting is not present in all nodes. The config file is better to store the setting in a persistent way.</p>
</blockquote>
<pre><code class="language-shell">psql postgres://&lt;PGPOOL_SR_CHECK_USER&gt;:&lt;PGPOOL_SR_CHECK_PASSWORD&gt;@localhost/postgres
</code></pre>
<p>Example:</p>
<pre><code class="language-shell">psql postgres://repdxuser:d1gitalRepExperience@localhost/postgres
</code></pre>
<p>To change and apply the level change, we use</p>
<pre><code class="language-sql">PGPOOL SET log_min_messages = 'DEBUG5';
</code></pre>
<h3 id="periodically-check-for-global-log-config-and-translate-to-compatible-log-config_1">Periodically check for global log config and translate to compatible log config</h3>
<p>We can create a shell script that runs in the image and periodically checks for changes in the global log config that is mounted in the container at <code>/etc/global-config/log.persistenceConnectionPool</code>.</p>
<p>Example log string:</p>
<pre><code>pers-pool:::info
</code></pre>
<pre><code class="language-shell">#!/bin/bash

#
####################################################################
# Licensed Materials - Property of HCL                             #
#                                                                  #
# Copyright HCL Technologies Ltd. 2021. All Rights Reserved.       #
#                                                                  #
# Note to US Government Users Restricted Rights:                   #
#                                                                  #
# Use, duplication or disclosure restricted by GSA ADP Schedule    #
####################################################################
#


# Load libraries
. /scripts/libpgpool.sh

# Load Pgpool env. variables
eval &quot;$(pgpool_env)&quot;

# Define service name
CURRENT_SERVICE=&quot;pers-pool&quot;

# Define log level mapping
declare -A map
map['debug']='DEBUG5' # logs DEBUG5, DEBUG4, DEBUG3, DEBUG2, DEBUG1
map['info']='INFO' # logs INFO, NOTICE, WARNING
map['error']='ERROR' # logs ERROR, LOG, FATAL, PANIC


Map_Level()
{
  # Transform to lowercase
  INPUT_LEVEL=$(echo &quot;$1&quot; | tr '[:upper:]' '[:lower:]')

  # Returns mapped value if it exists, oterwise empty string
  echo ${map[$INPUT_LEVEL]}
}

Parse_And_Set_Level()
{
  # Ex: &quot;pool:::info&quot;

  # Split by comma
  IFS=',' read -ra LOG_STR &lt;&lt;&lt; $1


  for LOG_PART in &quot;${LOG_STR[@]}&quot;; do
    # Split by colon
    IFS=':' read -ra LOG_STR_PARTS &lt;&lt;&lt; $LOG_PART

    # Get common log pattern elements
    SERVICE=${LOG_STR_PARTS[0]}
    # Transform to lowercase
    LOWERCASE_SERVICE=$(echo &quot;$SERVICE&quot; | tr '[:upper:]' '[:lower:]')

    # Suffix and component are currently not used in this service
    # SUFFIX=${LOG_STR_PARTS[1]}
    # COMPONENT=${LOG_STR_PARTS[2]}

    LEVEL=${LOG_STR_PARTS[${#LOG_STR_PARTS[@]} - 1]}

    # Only apply logs for the matching service
    if [[ $LOWERCASE_SERVICE == $CURRENT_SERVICE ]]; then
      MAPPED_LEVEL=$(Map_Level &quot;$LEVEL&quot;)

      if [[ $MAPPED_LEVEL != &quot;&quot; ]]; then
        # Setting the log level
        echo &quot;Setting log level to $MAPPED_LEVEL&quot; &amp;&amp; \
        pgpool_set_property &quot;log_min_messages&quot; $MAPPED_LEVEL &amp;&amp; \
        pgpool --config-file=$PGPOOL_CONF_FILE --hba-file=$PGPOOL_PGHBA_FILE reload || \
        echo &quot;Failed to set log level to $MAPPED_LEVEL&quot;
      fi
    fi

  done
}

Periodically_Read_Ronfigfile() {
  FILE_PATH=$1
  # Sleep time defaults to 10 seconds if not passed as argument
  SLEEP_TIME_SECONDS=${2:-10}

  LAST_CONFIG_STRING=''

  while [ true ]; do
    if [[ -f ${FILE_PATH} || -L ${FILE_PATH} ]]; then
      # Deal with the fact that the file referenced could actually be a symlink to a file
      FULLY_RESOLVED_FILE_PATH=$(readlink -f ${FILE_PATH})

      # read exactly the first line from that file
      read -r first_line &lt; ${FULLY_RESOLVED_FILE_PATH}
      if [ &quot;${LAST_CONFIG_STRING}&quot; != &quot;${first_line}&quot; ]; then
        LAST_CONFIG_STRING=${first_line}
        Parse_And_Set_Level &quot;$first_line&quot;
      else
        echo &quot;Nothing done because log config didn't change in ${FULLY_RESOLVED_FILE_PATH} in last&quot; ${SLEEP_TIME_SECONDS} &quot;seconds&quot;
    fi
    else
      echo &quot;Config map ${FILE_PATH} doesn't exist. No action taken&quot;
    fi
    sleep ${SLEEP_TIME_SECONDS}
  done
}

# Start periodic file check
Periodically_Read_Ronfigfile &quot;/etc/global-config/log.persistenceConnectionPool&quot; 10
</code></pre>
<p>It needs to be called from the entrypoint of the image and run permanently in the background.</p>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
 

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.indexes", "navigation.top", "navigation.instant", "navigation.expand", "search.highlight", "search.share", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.361d90f1.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.289a2a4b.min.js"></script>
      
    
  </body>
</html>